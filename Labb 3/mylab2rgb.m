function [R,G,B]=lab2rgb(L,a,b)

Xn = 95.05;
Yn = 100.00;
Zn = 108.89;

y=Yn*((L<=7.9996).*L/903.3+(L>7.9996).*((L+16)/116).^3);
ytemp=foo(y/Yn);
x=Xn*((a>(500*(0.2069-ytemp))).*(a/500+ytemp).^3+(a<=(500*(0.2069-ytemp))).*(a/500+ytemp-(16/116))/7.787);
z=Zn*((b<=(200*(ytemp-0.2069))).*(ytemp-b/200).^3+(b>(200*(ytemp-0.2069))).*(ytemp-b/200-(16/116))/7.787);
[n,m] = size(L);

Q = inv([41.2453 35.7580 18.0423; 21.2671 71.5160 7.2169; 1.9334 11.9193 95.0227]);

rgb=min(1,max(0,Q*[x(:)';y(:)';z(:)']));

R=reshape(rgb(1,:),n,m);
G=reshape(rgb(2,:),n,m);
B=reshape(rgb(3,:),n,m);
end


function y = foo(x)


y=(x<=0.008856).*(7.787*x+16/116)+(x>0.008856).*x.^(1/3);
end

